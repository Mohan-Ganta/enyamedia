generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  email     String   @unique
  password  String
  name      String
  role      String   @default("USER") // USER, ADMIN, SUPER_ADMIN
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  videos    Video[]
  activities Activity[]

  @@map("users")
}

model Video {
  id          String      @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  description String?
  filename    String
  originalName String
  mimeType    String
  size        Int
  duration    Int?        // in seconds
  thumbnail   String?
  status      String      @default("PROCESSING") // PROCESSING, READY, FAILED, DELETED
  views       Int         @default(0)
  likes       Int         @default(0)
  tags        String?     // JSON array as string
  category    String?
  isPublic    Boolean     @default(true)
  isFeatured  Boolean     @default(false) // Whether this video can appear in hero section
  uploadedBy  String      @db.ObjectId
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  // Relations
  uploader    User        @relation(fields: [uploadedBy], references: [id])
  activities  Activity[]

  @@map("videos")
}

model Activity {
  id        String       @id @default(auto()) @map("_id") @db.ObjectId
  type      String       // VIDEO_UPLOAD, VIDEO_DELETE, VIDEO_UPDATE, USER_LOGIN, USER_REGISTER, ADMIN_ACTION
  message   String
  userId    String?      @db.ObjectId
  videoId   String?      @db.ObjectId
  metadata  String?      // JSON as string
  createdAt DateTime     @default(now())

  // Relations
  user      User?        @relation(fields: [userId], references: [id])
  video     Video?       @relation(fields: [videoId], references: [id])

  @@map("activities")
}

